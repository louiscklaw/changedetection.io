name: changedetect

volumes:
  changedetection-data:

services:
  # TODO: for new changedetect test,
  # test with my nodejs + expressjs + puppeteer server
  new_changedetect:
    # image: ghcr.io/dgtlmoon/changedetection.io
    image: 192.168.10.61:5000/new_changedetect
    build: .
    container_name: changedetection
    hostname: changedetection

    # Configurable proxy list support, see https://github.com/dgtlmoon/changedetection.io/wiki/Proxy-configuration#proxy-list-support
    #        - ./proxies.json:/datastore/proxies.json
    volumes:
      - ./changedetection-data:/datastore
      #
      - ./changedetectionio:/app/changedetectionio
      - ./_notes:/app/_notes
      - ./changedetection.py:/app/changedetection.py
      - ./dev.sh:/app/dev.sh
      # - requirements.txt:/requirements.txt

    # Comment out ports: when using behind a reverse proxy , enable networks: etc.
    ports:
      - 5006:5000
    restart: unless-stopped

    # If WEBDRIVER or PLAYWRIGHT are enabled, changedetection container depends on that
    # and must wait before starting (substitute "browser-chrome" with "playwright-chrome" if last one is used)
    # depends_on:
    #   playwright-chrome:
    #     condition: service_started
    command: './dev.sh'

    environment:
      #  Default number of parallel/concurrent fetchers
      - FETCH_WORKERS=1

    #        Default listening port, can also be changed with the -p option
    #      - PORT=5000

    #      - PUID=1000
    #      - PGID=1000
    #
    #        Log levels are in descending order. (TRACE is the most detailed one)
    #        Log output levels: TRACE, DEBUG(default), INFO, SUCCESS, WARNING, ERROR, CRITICAL
    #      - LOGGER_LEVEL=DEBUG
    #
    #       Alternative WebDriver/selenium URL, do not use "'s or 's!
    #      - WEBDRIVER_URL=http://browser-chrome:4444/wd/hub
    #
    #       WebDriver proxy settings webdriver_proxyType, webdriver_ftpProxy, webdriver_noProxy,
    #                                webdriver_proxyAutoconfigUrl, webdriver_autodetect,
    #                                webdriver_socksProxy, webdriver_socksUsername, webdriver_socksVersion, webdriver_socksPassword
    #
    #             https://selenium-python.readthedocs.io/api.html#module-selenium.webdriver.common.proxy
    #
    #       Alternative Playwright URL, do not use "'s or 's!
    #      - PLAYWRIGHT_DRIVER_URL=ws://playwright-chrome:3000
    #
    #       Playwright proxy settings playwright_proxy_server, playwright_proxy_bypass, playwright_proxy_username, playwright_proxy_password
    #
    #             https://playwright.dev/python/docs/api/class-browsertype#browser-type-launch-option-proxy
    #
    #        Plain requests - proxy support example.
    #      - HTTP_PROXY=socks5h://10.10.1.10:1080
    #      - HTTPS_PROXY=socks5h://10.10.1.10:1080
    #
    #        An exclude list (useful for notification URLs above) can be specified by with
    #      - NO_PROXY="localhost,192.168.0.0/24"
    #
    #        Base URL of your changedetection.io install (Added to the notification alert)
    #      - BASE_URL=https://mysite.com
    #        Respect proxy_pass type settings, `proxy_set_header Host "localhost";` and `proxy_set_header X-Forwarded-Prefix /app;`
    #        More here https://github.com/dgtlmoon/changedetection.io/wiki/Running-changedetection.io-behind-a-reverse-proxy-sub-directory
    #      - USE_X_SETTINGS=1
    #
    #        Hides the `Referer` header so that monitored websites can't see the changedetection.io hostname.
    #      - HIDE_REFERER=true
    #

    #
    #        Absolute minimum seconds to recheck, overrides any watch minimum, change to 0 to disable
    #      - MINIMUM_SECONDS_RECHECK_TIME=3
